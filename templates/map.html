{% extends "bootstrap/base.html" %}

{% block title %}VRodu map{% endblock title %}

{% block metas %}
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
{% endblock metas %}

{% block styles %}
{% endblock styles %}

{% block content %}
    <div id="map" style="width: 800px; height: 600px"></div>
{% endblock content %}

{% block scripts %}
    {{ super() }}
    <script type="text/javascript" src="//vk.com/js/api/xd_connection.js"></script>
    <script type="text/javascript" src="https://api-maps.yandex.ru/2.1/?apikey=3e171cbb-7d54-47b4-98e5-21877d7eeb70&lang=ru_RU" ></script>
    <script type="text/javascript">
    ymaps.ready(init);
    function init(){
        var myMap = new ymaps.Map("map", {
            center: [55.76, 37.64],
            zoom: 7
        });
        locations = {{ locations | safe }};
        console.log(locations);
        addLocations(myMap, locations);
    }
    function addLocations(map, locations){
        for (a in locations){
            var myPlacemark = new ymaps.Placemark(locations[a].coordinates, {iconCaption: locations[a].person});
            map.geoObjects.add(myPlacemark);
        }
    }
    </script>
{% endblock scripts %}